import codonOpt
import logging

logging.basicConfig(level=logging.INFO)


codon_table = codonOpt.CodonTable(codon_tables_dir='Data/', json_file='Escherichia_coli_K12.json', low_cuttoff=0.1)
seq_gen = codonOpt.Sequence_Generator(codon_table, check_dna_to_protein=False)

dna_seq = 'ATGCGTGCAGTGGTGTTTGAAAACAAAGAGCGCGTTGCCGTCAAAGAAGTGAATGCTCCGCGTCTTCAGCACCCGTTGGATGCACTTGTGCGTGTACACTTAGCTGGGATTTGTGGCTCCGACCTCCATCTGTACCACGGTAAAATCCCTGTGCTCCCAGGCTCAGTCTTGGGCCATGAATTCGTTGGTCAGGTTGAAGCCGTCGGTGAAGGTATCCAGGACTTACAACCGGGTGATTGGGTGGTCGGGCCATTTCACATCGCTTGCGGCACTTGTCCATATTGTCGTCGTCATCAGTATAACTTGTGTGAACGTGGCGGTGTGTACGGTTATGGCCCGATGTTCGGTAATCTGCAGGGAGCCCAAGCAGAGATTTTACGCGTGCCGTTCAGCAACGTCAACCTGCGTAAACTGCCTCCGAATCTGTCCCCGGAACGCGCTATCTTTGCGGGTGATATCCTGAGCACCGCATACGGAGGACTCATCCAGGGTCAGCTTCGCCCGGGGGATTCCGTAGCAGTTATTGGAGCGGGCCCTGTAGGGTTAATGGCCATCGAAGTGGCACAGGTCCTTGGCGCATCTAAAATCCTGGCCATTGACCGTATCCCGGAGCGTCTGGAACGCGCGGCGTCCCTCGGCGCAATTCCAATTAATGCCGAACAGGAAAATCCGGTCCGCCGTGTGCGTTCGGAGACTAACGATGAGGGCCCGGATTTAGTTCTGGAAGCGGTAGGCGGTGCGGCAACCCTTTCATTAGCGCTGGAAATGGTTCGCCCTGGCGGTCGCGTTTCTGCGGTGGGGGTCGATAACGCGCCATCATTCCCGTTCCCCCTTGCGTCTGGCCTGGTAAAAGATTTAACGTTTCGTATCGGCCTCGCAAACGTGCATCTCTACATCGATGCCGTCTTAGCCCTGTTAGCCTCTGGCCGTCTCCAACCCGAGCGTATTGTCAGCCACTATTTACCTCTGGAAGAAGCGCCGCGTGGCTATGAATTATTCGACCGTAAAGAAGCTTTAAAGGTGCTGCTGGTGGTGCGCGGGGGTGGTAGTGGAGATTACAAAGACGATGATGATAAGTGATAA'

# Only optimise the first 51 base-pairs
dna_seq = seq_gen.redesign_section(dna_seq, 0, 51)

# But remove any of these restriction sites from the entire sequence
motifs_to_remove = ["ATTtt", 'GGaAt', "TaAAt"]
dna_seq = seq_gen.motif_removal(dna_seq, motifs_to_remove)





"""
---Optional---
One possibility is to minimise the RNA folding energy in the first 51 base-pairs below a specified limit
"""
dna_seq = seq_gen.minimise_mfe_five_prime(dna_seq, -8, five_prime_length=51)
print(dna_seq)